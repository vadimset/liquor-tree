/*!
 * LiquorTree v0.2.70
 * (c) 2023 amsik
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e=e||self).LiquorTree=t(e.vue)}(this,function(t){"use strict";var e={name:"node-content",props:["node"],render:function(e){var t,n=this,i=this.node,r=this.node.tree.vm;return i.isEditing?(t=i.text,this.$nextTick(function(e){n.$refs.editCtrl.focus()}),e("input",{domProps:{value:i.text,type:"text"},class:"tree-input",on:{input:function(e){t=e.target.value},blur:function(){i.stopEditing(t)},keyup:function(e){13===e.keyCode&&i.stopEditing(t)},mouseup:function(e){e.stopPropagation()}},ref:"editCtrl"})):r.$scopedSlots.default?r.$scopedSlots.default({node:this.node}):e("span",{domProps:{innerHTML:i.text}})}};function n(e,t,n,i,r,o,s,a,d,c){"function"==typeof s&&(d=a,a=s,s=!1);var h,l,p="function"==typeof n?n.options:n;return e&&e.render&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0,r)&&(p.functional=!0),i&&(p._scopeId=i),o?(h=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,d(e)),e&&e._registeredComponents&&e._registeredComponents.add(o)},p._ssrRegister=h):t&&(h=s?function(){t.call(this,c(this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),h&&(p.functional?(l=p.render,p.render=function(e,t){return h.call(t),l(e,t)}):(e=p.beforeCreate,p.beforeCreate=e?[].concat(e,h):[h])),n}var i=e,e=(e.__file="NodeContent.vue",{name:"Node",inject:["tree"],props:["node","options"],components:{NodeContent:n({},void 0,i,void 0,void 0,void 0,void 0,void 0)},watch:{node:function(){this.node.vm=this}},data:function(){return this.node.vm=this,{loading:!1}},computed:{padding:function(){return this.node.depth*(this.options.paddingLeft||this.options.nodeIndent)+"px"},nodeClass:function(){var e=this.node.states,t=this.hasChildren(),t={"has-child":t,expanded:t&&e.expanded,selected:e.selected,disabled:e.disabled,matched:e.matched,dragging:e.dragging,loading:this.loading,draggable:e.draggable};return this.options.checkbox&&(t.checked=e.checked,t.indeterminate=e.indeterminate),t},visibleChildren:function(){return this.node.children.filter(function(e){return e&&e.visible()})}},methods:{onNodeFocus:function(){this.tree.activeElement=this.node},focus:function(){this.$refs.anchor.focus(),this.node.select()},check:function(){this.node.checked()?this.node.uncheck():this.node.check()},select:function(e){var e=(e=void 0===e?evnt:e).ctrlKey,t=this.options,n=this.tree,i=this.node;if(n.$emit("node:clicked",i),!t.editing||!i.isEditing)return t.editing&&i.editable()?this.startEditing():t.checkbox&&t.checkOnSelect?!t.parentSelect&&this.hasChildren()?this.toggleExpand():this.check(e):(!t.parentSelect&&this.hasChildren()&&this.toggleExpand(),void(t.multiple?i.selected()?e?i.unselect():1!=this.tree.selectedNodes.length&&(n.unselectAll(),i.select()):i.select(e):i.selected()&&e?i.unselect():i.select()))},toggleExpand:function(){this.hasChildren()&&this.node.toggleExpand()},hasChildren:function(){return this.node.hasChildren()},startEditing:function(){this.tree._editingNode&&this.tree._editingNode.stopEditing(),this.node.startEditing()},stopEditing:function(){this.node.stopEditing()},handleMouseDown:function(e){this.options.dnd&&this.tree.vm.startDragging(this.node,e)}}}),r="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function o(e){return function(e,t){var n,i=r?t.media||"default":e;(i=a[i]||(a[i]={ids:new Set,styles:[]})).ids.has(e)||(i.ids.add(e),e=t.source,t.map&&(e=(e+="\n/*# sourceURL="+t.map.sources[0]+" */")+"\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",t.media&&i.element.setAttribute("media",t.media),s.appendChild(i.element)),"styleSheet"in i.element?(i.styles.push(e),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n")):(t=i.ids.size-1,e=document.createTextNode(e),(n=i.element.childNodes)[t]&&i.element.removeChild(n[t]),n.length?i.element.insertBefore(e,n[t]):i.element.appendChild(e)))}}var s=document.head||document.getElementsByTagName("head")[0],a={};i=n({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"tree-node",class:t.nodeClass,attrs:{role:"treeitem","data-id":t.node.id},on:{mousedown:function(e){return e.stopPropagation(),t.handleMouseDown.apply(null,arguments)}}},[n("div",{staticClass:"tree-content",style:["ltr"==t.options.direction?{"padding-left":t.padding}:{"padding-right":t.padding}],on:{click:function(e){return e.stopPropagation(),t.select.apply(null,arguments)}}},[n("i",{staticClass:"tree-arrow",class:[{expanded:t.node.states.expanded,"has-child":t.node.children.length||t.node.isBatch},t.options.direction],on:{click:function(e){return e.stopPropagation(),t.toggleExpand.apply(null,arguments)}}}),t._v(" "),t.options.checkbox?n("i",{staticClass:"tree-checkbox",class:{checked:t.node.states.checked,indeterminate:t.node.states.indeterminate},on:{click:function(e){return e.stopPropagation(),t.check.apply(null,arguments)}}}):t._e(),t._v(" "),n("span",{ref:"anchor",staticClass:"tree-anchor",attrs:{tabindex:"-1"},on:{focus:t.onNodeFocus,dblclick:function(e){return t.tree.$emit("node:dblclick",t.node)}}},[n("node-content",{attrs:{node:t.node}})],1)]),t._v(" "),n("transition",{attrs:{name:"l-fade"}},[t.hasChildren()&&t.node.states.expanded?n("ul",{staticClass:"tree-children"},t._l(t.visibleChildren,function(e){return n("node",{key:e.id,attrs:{node:e,options:t.options}})}),1):t._e()])],1)},staticRenderFns:[]},function(e){e&&e("data-v-c58df0ac_0",{source:'.tree-node{white-space:nowrap;display:flex;flex-direction:column;position:relative;box-sizing:border-box}.tree-content{display:flex;align-items:center;padding:3px;cursor:pointer;width:100%;box-sizing:border-box}.tree-node:not(.selected)>.tree-content:hover{background:#f6f8fb}.tree-node.selected>.tree-content{background-color:#e7eef7}.tree-node.disabled>.tree-content:hover{background:inherit}.tree-arrow{flex-shrink:0;height:30px;cursor:pointer;margin-left:30px;width:0}.tree-arrow.has-child{margin-left:0;width:30px;position:relative}.tree-arrow.has-child:after{border:1.5px solid #494646;position:absolute;border-left:0;border-top:0;left:9px;top:50%;height:9px;width:9px;transform:rotate(-45deg) translateY(-50%) translateX(0);transition:transform .25s;transform-origin:center}.tree-arrow.has-child.rtl:after{border:1.5px solid #494646;position:absolute;border-right:0;border-bottom:0;right:0;top:50%;height:9px;width:9px;transform:rotate(-45deg) translateY(-50%) translateX(0);transition:transform .25s;transform-origin:center}.tree-arrow.expanded.has-child:after{transform:rotate(45deg) translateY(-50%) translateX(-5px)}.tree-checkbox{flex-shrink:0;position:relative;width:30px;height:30px;box-sizing:border-box;border:1px solid #dadada;border-radius:2px;background:#fff;transition:border-color .25s,background-color .25s}.tree-arrow:after,.tree-checkbox:after{position:absolute;display:block;content:""}.tree-checkbox.checked,.tree-checkbox.indeterminate{background-color:#3a99fc;border-color:#218eff}.tree-checkbox.checked:after{box-sizing:content-box;border:1.5px solid #fff;border-left:0;border-top:0;left:9px;top:3px;height:15px;width:8px;transform:rotate(45deg) scaleY(0);transition:transform .25s;transform-origin:center}.tree-checkbox.checked:after{transform:rotate(45deg) scaleY(1)}.tree-checkbox.indeterminate:after{background-color:#fff;top:50%;left:20%;right:20%;height:2px}.tree-anchor{flex-grow:2;outline:0;display:flex;text-decoration:none;color:#343434;vertical-align:top;margin-left:3px;line-height:24px;padding:3px 6px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-node.selected>.tree-content>.tree-anchor{outline:0}.tree-node.disabled>.tree-content>.tree-anchor{color:#989191;background:#fff;opacity:.6;cursor:default;outline:0}.tree-input{display:block;width:100%;height:24px;line-height:24px;outline:0;border:1px solid #3498db;padding:0 4px}.l-fade-enter-active,.l-fade-leave-active{transition:opacity .3s,transform .3s;transform:translateX(0)}.l-fade-enter,.l-fade-leave-to{opacity:0;transform:translateX(-2em)}.tree--small .tree-anchor{line-height:19px}.tree--small .tree-checkbox{width:23px;height:23px}.tree--small .tree-arrow{height:23px}.tree--small .tree-checkbox.checked:after{left:7px;top:3px;height:11px;width:5px}.tree-node.has-child.loading>.tree-content>.tree-arrow,.tree-node.has-child.loading>.tree-content>.tree-arrow:after{border-radius:50%;width:15px;height:15px;border:0}.tree-node.has-child.loading>.tree-content>.tree-arrow{font-size:3px;position:relative;border-top:1.1em solid rgba(45,45,45,.2);border-right:1.1em solid rgba(45,45,45,.2);border-bottom:1.1em solid rgba(45,45,45,.2);border-left:1.1em solid #2d2d2d;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);left:5px;-webkit-animation:loading 1.1s infinite linear;animation:loading 1.1s infinite linear;margin-right:8px}@-webkit-keyframes loading{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes loading{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}',map:void 0,media:void 0})},e,void 0,!(e.__file="TreeNode.vue"),void 0,o,void 0),e={name:"DragNode",props:["target"],computed:{style:function(){return void 0===this.target.top?"display: none":"top: "+this.target.top+"px; left: "+this.target.left+"px"}}},e=n({render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"tree-dragnode",style:e.style},[e._v("\n  "+e._s(e.target.node.text)+"\n")])},staticRenderFns:[]},function(e){e&&e("data-v-6cd9e211_0",{source:".tree-dragnode{padding:10px;border:1px solid #e7eef7;position:fixed;border-radius:8px;background:#fff;transform:translate(-50%,-110%);z-index:10}",map:void 0,media:void 0})},e,void 0,!(e.__file="DraggableNode.vue"),void 0,o,void 0);function d(e,t){var n;return Array.isArray(e)?e.map(function(e){return d(e,t)}):!1!==(n=t(e))&&e.children&&e.children.length?d(e.children,t):n}function c(e){return!1==!!document?e:(c.__element||(c.__element=document.createElement("div")),c.__element.innerHTML=e,c.__element.innerText)}function h(o){return function(r){return Object.keys(o).every(function(t){var e,n,i;return"text"===t||"id"===t?(e=o[t],n=c(n=r[t]),e instanceof RegExp?e.test(n):e===n):(i=o[t],"state"===t&&(t="states"),Object.keys(i).every(function(e){return r[t][e]===i[e]}))})}}function l(e,t,n){if(!e||!e.length||!t)return null;var i;if((n=void 0===n?!0:n)&&(i=[],e.forEach(function e(t){i.push(t),t.children&&t.children.forEach(e)}),e=i),"number"==typeof t)return e[t]||null;"function"!=typeof(t="string"==typeof t||t instanceof RegExp?{text:t}:t)&&(t=h(t));n=e.filter(t);return n.length?n:null}function p(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function u(){return p()+p()+"-"+p()+"-"+p()+"-"+p()+"-"+p()+p()+p()}function f(e,t){for(var n=[],i=arguments.length-2;0<i--;)n[i]=arguments[i+2];e.forEach(function(e){return e[t].apply(e,n)})}function g(e,t){if(!t)throw new Error("Node can not be empty");if(this.id=t.id||u(),this.states=t.state||{},this.showChildren=!0,this.children=t.children||[],this.parent=t.parent||null,this.isBatch=t.isBatch||!1,this.isEditing=!1,this.data=Object.assign({},t.data||{},{text:t.text}),!e)throw new Error("Node must have a Tree context!");this.tree=e}var m=function(n){function e(e,t){void 0===t&&(t=[]),n.call(this),this.tree=e,this.push.apply(this,t)}return n&&(e.__proto__=n),((e.prototype=Object.create(n&&n.prototype)).constructor=e).prototype.remove=function(){return f(this,"remove"),this},e.prototype.expand=function(){return f(this,"expand"),this},e.prototype.collapse=function(){return f(this,"collapse"),this},e.prototype.select=function(e){return f(this,"select",e),this},e.prototype.unselect=function(){return f(this,"unselect"),this},e.prototype.check=function(){return this.tree.options.checkbox&&f(this,"check"),this},e.prototype.uncheck=function(){return this.tree.options.checkbox&&f(this,"uncheck"),this},e.prototype.disable=function(){return f(this,"disable"),this},e.prototype.enable=function(){return f(this,"enable"),this},e}(Array),b={key:{configurable:!0},depth:{configurable:!0},text:{configurable:!0}},v=(g.prototype.$emit=function(e){for(var t,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];(t=this.tree).$emit.apply(t,["node:"+e,this].concat(n))},g.prototype.getPath=function(){if(!this.parent)return[this];for(var e=[this],t=this;null!==(t=t.parent);)e.push(t);return e},b.key.get=function(){return this.id+this.text},b.depth.get=function(){var e=0,t=this.parent;if(t&&!1!==this.showChildren)for(;e++,t=t.parent;);return e},b.text.get=function(){return this.data.text},b.text.set=function(e){var t=this.text;t!==e&&(this.data.text=e,this.$emit("text:changed",e,t))},g.prototype.setData=function(e){return this.data=Object.assign({},this.data,e),this.$emit("data:changed",this.data),this.data},g.prototype.state=function(e,t){return void 0===t?this.states[e]:(this.states[e]=t,this)},g.prototype.recurseUp=function(e,t){return(t=void 0===t?this:t).parent&&!1!==e(t.parent)?this.recurseUp(e,t.parent):void 0},g.prototype.recurseDown=function(e,t){!0!==t&&e(this),this.hasChildren()&&d(this.children,e)},g.prototype.refreshIndeterminateState=function(){if(!this.tree.options.autoCheckChildren)return this;var e,t,n,i;this.state("indeterminate",!1),this.hasChildren()&&(e=this.children.length,i=n=t=0,this.children.forEach(function(e){e.checked()&&t++,e.disabled()&&i++,e.indeterminate()&&n++}),0<t&&t===e-i?this.checked()||(this.state("checked",!0),this.tree.check(this),this.$emit("checked")):(this.checked()&&(this.state("checked",!1),this.tree.uncheck(this),this.$emit("unchecked")),this.state("indeterminate",0<n||0<t&&t<e))),this.parent&&this.parent.refreshIndeterminateState()},g.prototype.indeterminate=function(){return this.state("indeterminate")},g.prototype.editable=function(){return!this.state("disabled")&&this.state("editable")},g.prototype.selectable=function(){return!this.state("disabled")&&this.state("selectable")},g.prototype.selected=function(){return this.state("selected")},g.prototype.select=function(e){return this.selectable()&&!this.selected()&&(this.tree.select(this,e),this.state("selected",!0),this.$emit("selected")),this},g.prototype.unselect=function(){return this.selectable()&&this.selected()&&(this.tree.unselect(this),this.state("selected",!1),this.$emit("unselected")),this},g.prototype.checked=function(){return this.state("checked")},g.prototype.check=function(){var t=this;if(!this.checked()&&!this.disabled()){if(this.indeterminate())return this.uncheck();var n=this.tree.options.checkDisabledChildren,i=this;this.tree.options.autoCheckChildren?(this.recurseDown(function(e){e.state("indeterminate",!1),e.disabled()&&!n||e.checked()||(t.tree.check(e),e.state("checked",!0),e.$emit("checked",e.id===i.id?void 0:i))}),this.parent&&this.parent.refreshIndeterminateState()):(this.tree.check(this),this.state("checked",!0),this.$emit("checked"))}return this},g.prototype.uncheck=function(){var t,n=this;return!this.indeterminate()&&!this.checked()||this.disabled()||((t=this).tree.options.autoCheckChildren?(this.recurseDown(function(e){e.state("indeterminate",!1),e.checked()&&(n.tree.uncheck(e),e.state("checked",!1),e.$emit("unchecked",e.id===t.id?void 0:t))}),this.parent&&this.parent.refreshIndeterminateState()):(this.tree.uncheck(this),this.state("checked",!1),this.$emit("unchecked"))),this},g.prototype.show=function(){return this.visible()||(this.state("visible",!0),this.$emit("shown")),this},g.prototype.hide=function(){return this.hidden()||(this.state("visible",!1),this.$emit("hidden")),this},g.prototype.visible=function(){return this.state("visible")},g.prototype.hidden=function(){return!this.state("visible")},g.prototype.enable=function(){return this.enabled()||(this.tree.options.autoDisableChildren?this.recurseDown(function(e){e.disabled()&&(e.state("disabled",!1),e.$emit("enabled"))}):(this.state("disabled",!1),this.$emit("enabled"))),this},g.prototype.enabled=function(){return!this.state("disabled")},g.prototype.disable=function(){return this.disabled()||(this.tree.options.autoDisableChildren?this.recurseDown(function(e){e.enabled()&&(e.state("disabled",!0),e.$emit("disabled"))}):(this.state("disabled",!0),this.$emit("disabled"))),this},g.prototype.disabled=function(){return this.state("disabled")},g.prototype.expandTop=function(t){var n=this;this.recurseUp(function(e){e.state("expanded",!0),!0!==t&&n.$emit("expanded",e)})},g.prototype.expand=function(){var t=this;return this.canExpand()&&(this.isBatch?this.tree.loadChildren(this).then(function(e){t.state("expanded",!0),t.$emit("expanded")}):(this.state("expanded",!0),this.$emit("expanded"))),this},g.prototype.canExpand=function(){return!(this.disabled()||!this.hasChildren())&&this.collapsed()&&(!this.tree.autoDisableChildren||this.disabled())},g.prototype.canCollapse=function(){return!(this.disabled()||!this.hasChildren())&&this.expanded()&&(!this.tree.autoDisableChildren||this.disabled())},g.prototype.expanded=function(){return this.state("expanded")},g.prototype.collapse=function(){return this.canCollapse()&&(this.state("expanded",!1),this.$emit("collapsed")),this},g.prototype.collapsed=function(){return!this.state("expanded")},g.prototype.toggleExpand=function(){return this._toggleOpenedState()},g.prototype.toggleCollapse=function(){return this._toggleOpenedState()},g.prototype._toggleOpenedState=function(){return this.canCollapse()?this.collapse():this.canExpand()?this.expand():void 0},g.prototype.isDropable=function(){return this.enabled()&&this.state("dropable")},g.prototype.isDraggable=function(){return this.enabled()&&this.state("draggable")&&!this.isEditing},g.prototype.startDragging=function(){return!(!this.isDraggable()||this.state("dragging")||this.isRoot()&&1===this.tree.model.length||(this.tree.options.store&&(this.tree.__silence=!0),this.select(),this.state("dragging",!0),this.$emit("dragging:start"),this.tree.__silence=!1))},g.prototype.finishDragging=function(e,t){var n,i,r;(e.isDropable()||"drag-on"!==t)&&(n=this.tree,i=this.clone(),r=this.parent,i.id=this.id,n.__silence=!0,this.remove(),"drag-on"===t?n.append(e,i):"drag-below"===t?n.after(e,i):"drag-above"===t&&n.before(e,i),e.refreshIndeterminateState(),r&&r.refreshIndeterminateState(),n.__silence=!1,i.state("dragging",!1),this.state("dragging",!1),i.$emit("dragging:finish",e,t),i.state("selected")&&(n.selectedNodes.remove(this),n.selectedNodes.add(i),n.vm.$set(this.state,"selected",!1),n.vm.$set(i.state,"selected",!0)),this.tree.options.store)&&this.tree.vm.$emit("LIQUOR_NOISE")},g.prototype.startEditing=function(){if(this.disabled())return!1;this.isEditing||(((this.tree._editingNode=this).tree.activeElement=this).isEditing=!0,this.$emit("editing:start"))},g.prototype.stopEditing=function(e){var t;this.isEditing&&(this.isEditing=!1,this.tree._editingNode=null,this.tree.activeElement=null,t=this.text,e&&!1!==e&&this.text!==e&&(this.text=e),this.$emit("editing:stop",t))},g.prototype.index=function(e){return this.tree.index(this,e)},g.prototype.first=function(){return this.hasChildren()?this.children[0]:null},g.prototype.last=function(){return this.hasChildren()?this.children[this.children.length-1]:null},g.prototype.next=function(){return this.tree.nextNode(this)},g.prototype.prev=function(){return this.tree.prevNode(this)},g.prototype.insertAt=function(e,t){var n=this;if(void 0===t&&(t=this.children.length),e)return e=this.tree.objectToNode(e),Array.isArray(e)?(e.reverse().map(function(e){return n.insertAt(e,t)}),new m(this.tree,[].concat(e))):((e.parent=this).children.splice(t,0,e),e.disabled()&&e.hasChildren()&&e.recurseDown(function(e){e.state("disabled",!0)}),this.isBatch||this.$emit("added",e),e)},g.prototype.addChild=function(e){return this.insertAt(e)},g.prototype.append=function(e){return this.addChild(e)},g.prototype.prepend=function(e){return this.insertAt(e,0)},g.prototype.before=function(e){return this.tree.before(this,e)},g.prototype.after=function(e){return this.tree.after(this,e)},g.prototype.empty=function(){for(var e;e=this.children.pop();)e.remove();return this},g.prototype.remove=function(){return this.tree.removeNode(this)},g.prototype.removeChild=function(e){e=this.find(e);return e?this.tree.removeNode(e):null},g.prototype.find=function(e,t){return this.tree.isNode(e)?e:l(this.children,e,t)},g.prototype.focus=function(){this.vm&&this.vm.focus()},g.prototype.hasChildren=function(){return this.showChildren&&this.isBatch||0<this.children.length},g.prototype.isRoot=function(){return null===this.parent},g.prototype.clone=function(){return this.tree.objectToNode(this.toJSON())},g.prototype.toJSON=function(){var t=this;return{text:this.text,data:this.data,state:this.states,children:this.children.map(function(e){return t.tree.objectToNode(e).toJSON()})}},Object.defineProperties(g.prototype,b),{selected:!1,selectable:!0,checked:!1,expanded:!1,disabled:!1,visible:!0,indeterminate:!1,matched:!1,editable:!0,dragging:!1,draggable:!0,dropable:!0});function y(e){return void 0===e&&(e={}),Object.assign({},v,e)}function x(t,e){var n=null;if(e instanceof g)return e;if("string"==typeof e)n=new g(t,{text:e,state:y(),id:u()});else{if(Array.isArray(e))return e.map(function(e){return x(t,e)});(n=new g(t,e)).states=y(n.states),n.id||(n.id=u()),n.children.length&&(n.children=n.children.map(function(e){return(e=x(t,e)).parent=n,e}))}return n}var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.empty=function(){return this.splice(0,this.length),this},t.prototype.has=function(e){return this.includes(e)},t.prototype.add=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return this.push.apply(this,e),this},t.prototype.remove=function(e){e=this.indexOf(e);return-1!==e&&this.splice(e,1),this},t.prototype.removeAll=function(e){for(;this.includes(e);)this.remove(e);return this},t.prototype.top=function(){return this[this.length-1]},t}(Array),$={id:"id",text:"text",children:"children",state:"state",data:"data",isBatch:"isBatch"};var N=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)||(e=[e]);var i=Object.assign({},$,n);return e.map(function e(t){t={id:t[i.id],text:t[i.text],children:t[i.children],state:t[i.state],data:t[i.data],isBatch:t[i.isBatch]};return t.children&&!Array.isArray(t.children)&&(t.children=[t.children]),t.children&&(t.children=t.children.map(e)),t}).map(function(e){return x(t,e)})};function w(e){return t=e,new Promise(function(n,i){var r=new XMLHttpRequest;r.open("GET",t),r.setRequestHeader("Content-Type","application/json"),r.addEventListener("load",function(e){try{var t=JSON.parse(r.response);n(t)}catch(e){i(e)}}),r.send(null)});var t}function D(e,t){return e.text<t.text?-1:e.text>t.text?1:0}function C(e,t){return e.text<t.text?1:e.text>t.text?-1:0}function _(e,t){"string"==typeof t&&(t=function(e){switch(e.toLowerCase()){case"asc":return D;case"desc":return C}}(t)),Array.isArray(e)&&"function"==typeof t&&e.sort(t)}function E(e){var r,t,n=this;this.vm=e,this.options=e.opts,this.activeElement=null,"string"==typeof(e=this.options.fetchData)&&(this.options.fetchData=(r=e,t=function(e){for(var t,n=/{([^}]+)}/,i=r;t=n.exec(i);)i=i.replace(t[0],e[t[1]]);return i},function(e){return w(t(e)).catch(n.options.onFetchError)}))}function O(e,t){if(!1===e)throw new Error(t)}function S(n){function i(e){var t=n.selected();o?n.$emit("input",{selected:r?t:t[0]||null,checked:n.checked()}):n.$emit("input",r?t:t[0]||null)}var e=n.opts,r=e.multiple,o=e.checkbox,s=n.tree;i(),s.$on("node:selected",i),s.$on("node:unselected",i),o&&(s.$on("node:checked",i),s.$on("node:unchecked",i)),s.$on("node:added",function(e,t){t=t||e;o&&(t.state("checked")&&!s.checkedNodes.has(t)&&s.checkedNodes.add(t),t.refreshIndeterminateState()),t.state("selected")&&!s.selectedNodes.has(t)&&s.select(t),i()})}E.prototype.$on=function(e){for(var t,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];(t=this.vm).$on.apply(t,[e].concat(n))},E.prototype.$once=function(e){for(var t,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];(t=this.vm).$once.apply(t,[e].concat(n))},E.prototype.$off=function(e){for(var t,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];(t=this.vm).$off.apply(t,[e].concat(n))},E.prototype.$emit=function(e){for(var t,n=[],i=arguments.length-1;0<i--;)n[i]=arguments[i+1];this.__silence||((t=this.vm).$emit.apply(t,[e].concat(n)),this.options.store&&this.vm.$emit("LIQUOR_NOISE"))},E.prototype._sort=function(e,t,n){!1!==n&&this.recurseDown(e,function(e){e.hasChildren()&&_(e.children,t)}),_(e,t)},E.prototype.sortTree=function(e,t){this._sort(this.model,e,t)},E.prototype.sort=function(e,t,n){var i=this,e=this.find(e,!0);e&&t&&e.forEach(function(e){i._sort(e.children,t,n)})},E.prototype.clearFilter=function(){this.recurseDown(function(e){e.state("matched",!1),e.state("visible",!0),e.state("expanded",e.__expanded),e.__expanded=void 0,e.showChildren=!0}),this.vm.matches.length=0,this.vm.$emit("tree:filtered",[],"")},E.prototype.filter=function(t){var n,i,e,r,o;return t?(n=[],i=this.options.filter.matcher,e=this.options.filter,r=e.showChildren,o=e.plainList,this.recurseDown(function(e){i(t,e)&&n.push(e),e.showChildren=!0,void 0===e.__expanded&&(e.__expanded=e.state("expanded")),e.state("visible",!1),e.state("matched",!1),e.state("expanded",!0)}),n.reverse().forEach(function(e){e.state("matched",!0),e.state("visible",!0),e.showChildren=!o,e.hasChildren()&&e.recurseDown(function(e){e.state("visible",!!r)},!0),e.recurseUp(function(e){e.state("visible",!0),e.state("expanded",!0)}),e.hasChildren()&&e.state("expanded",!1)}),this.vm.matches=n,this.vm.$emit("tree:filtered",n,t),n):this.clearFilter()},E.prototype.selected=function(){return new(Function.prototype.bind.apply(m,[null].concat([this],this.selectedNodes)))},E.prototype.checked=function(){return this.options.checkbox?new(Function.prototype.bind.apply(m,[null].concat([this],this.checkedNodes))):null},E.prototype.loadChildren=function(t){var n,i,r=this;if(t)return this.$emit("tree:data:fetch",t),0<this.options.minFetchDelay&&t.vm&&(t.vm.loading=!0),n=this.fetch(t).then(function(e){t.append(e),t.isBatch=!1,r.options.autoCheckChildren&&(t.checked()&&t.recurseDown(function(e){e.state("checked",!0)}),t.refreshIndeterminateState()),r.$emit("tree:data:received",t)}),Promise.all([(i=this.options.minFetchDelay,new Promise(function(e){setTimeout(e,i)})),n]).then(function(e){return t.vm&&(t.vm.loading=!1),n})},E.prototype.fetch=function(e,t){var n=this,e=this.options.fetchData(e);return e.then||(e=w(e).catch(this.options.onFetchError)),!1===t?e:e.then(function(e){try{return n.parse(e,n.options.modelParse)}catch(e){throw new Error(e)}}).catch(this.options.onFetchError)},E.prototype.fetchInitData=function(){return this.fetch({id:"root",name:"root"},!1)},E.prototype.setModel=function(e){var i=this;return new Promise(function(t){var n;i.model=i.parse(e,i.options.modelParse),requestAnimationFrame(function(e){i.vm.model=i.model,t()}),i.selectedNodes=new k,i.checkedNodes=new k,d(i.model,function(e){e.tree=i,e.selected()&&i.selectedNodes.add(e),e.checked()&&(i.checkedNodes.add(e),e.parent)&&e.parent.refreshIndeterminateState(),i.options.autoDisableChildren&&e.disabled()&&e.recurseDown(function(e){e.state("disabled",!0)})}),!i.options.multiple&&i.selectedNodes.length&&(n=i.selectedNodes.top(),i.selectedNodes.forEach(function(e){n!==e&&e.state("selected",!1)}),i.selectedNodes.empty().add(n)),i.options.checkOnSelect&&i.options.checkbox&&i.unselectAll()})},E.prototype.recurseDown=function(e,t){return!t&&e&&(t=e,e=this.model),d(e,t)},E.prototype.select=function(e,t){e=this.getNode(e);return!!e&&((this.options.multiple&&t?this.selectedNodes:(this.unselectAll(),this.selectedNodes.empty())).add(e),!0)},E.prototype.selectAll=function(){var t=this;return!!this.options.multiple&&(this.selectedNodes.empty(),this.recurseDown(function(e){t.selectedNodes.add(e.select(!0))}),!0)},E.prototype.unselect=function(e){e=this.getNode(e);return!!e&&(this.selectedNodes.remove(e),!0)},E.prototype.unselectAll=function(){for(var e;e=this.selectedNodes.pop();)e.unselect();return!0},E.prototype.check=function(e){this.checkedNodes.add(e)},E.prototype.uncheck=function(e){this.checkedNodes.remove(e)},E.prototype.checkAll=function(){this.recurseDown(function(e){0===e.depth&&(e.indeterminate()&&e.state("indeterminate",!1),e.check())})},E.prototype.uncheckAll=function(){for(var e;e=this.checkedNodes.pop();)e.uncheck();return!0},E.prototype.expand=function(e){return!e.expanded()&&(e.expand(),!0)},E.prototype.collapse=function(e){return!e.collapsed()&&(e.collapse(),!0)},E.prototype.toggleExpand=function(e){return!!e.hasChildren()&&(e.toggleExpand(),!0)},E.prototype.toggleCollapse=function(e){return!!e.hasChildren()&&(e.toggleCollapse(),!0)},E.prototype.expandAll=function(){this.recurseDown(function(e){e.hasChildren()&&e.collapsed()&&e.expand()})},E.prototype.collapseAll=function(){this.recurseDown(function(e){e.hasChildren()&&e.expanded()&&e.collapse()})},E.prototype.index=function(e,t){var n=e.parent,e=(n=n?n.children:this.model).indexOf(e);return t?{index:e,target:n,node:n[e]}:e},E.prototype.nextNode=function(e){e=this.index(e,!0);return e.target[e.index+1]||null},E.prototype.nextVisibleNode=function(e){var t;return e.hasChildren()&&e.expanded()?e.first():!(t=this.nextNode(e))&&e.parent?e.parent.next():t},E.prototype.prevNode=function(e){e=this.index(e,!0);return e.target[e.index-1]||null},E.prototype.prevVisibleNode=function(e){var t=this.prevNode(e);return t?t.hasChildren()&&t.expanded()?t.last():t:e.parent},E.prototype.addToModel=function(e,t){var n=this;return void 0===t&&(t=this.model.length),e=this.objectToNode(e),this.model.splice(t,0,e),this.recurseDown(e,function(e){e.tree=n}),this.$emit("node:added",e),e},E.prototype.append=function(e,t){e=this.find(e);return!!e&&e.append(t)},E.prototype.prepend=function(e,t){e=this.find(e);return!!e&&e.prepend(t)},E.prototype.before=function(e,t){e=this.find(e);var n=this.index(e,!0),t=this.objectToNode(t);return!!~n.index&&(n.target.splice(n.index,0,t),t.parent=e.parent,this.$emit("node:added",t),t)},E.prototype.after=function(e,t){e=this.find(e);var n=this.index(e,!0),t=this.objectToNode(t);return!!~n.index&&(n.target.splice(n.index+1,0,t),t.parent=e.parent,this.$emit("node:added",t),t)},E.prototype.addNode=function(e){var t=this.model.length;return e=x(e),this.model.splice(t,0,e),this.$emit("node:added",e),e},E.prototype.remove=function(e,t){return this.removeNode(this.find(e,t))},E.prototype.removeNode=function(e){var t;return e instanceof m?e.remove():!!e&&(e.parent?~(t=e.parent.children).indexOf(e)&&t.splice(t.indexOf(e),1):~this.model.indexOf(e)&&this.model.splice(this.model.indexOf(e),1),e.parent&&e.parent.indeterminate()&&!e.parent.hasChildren()&&e.parent.state("indeterminate",!1),null!==this.activeElement&&e.id===this.activeElement.id&&(this.activeElement=null),e.parent=null,this.$emit("node:removed",e),this.selectedNodes.remove(e),this.checkedNodes.remove(e),(t=this.vm.matches)&&t.length&&t.includes(e)&&t.splice(t.indexOf(e),1),e)},E.prototype.isNode=function(e){return e instanceof g},E.prototype.find=function(e,t){return this.isNode(e)?e:(e=l(this.model,e))&&e.length?new m(this,!0===t?e:[e[0]]):new m(this,[])},E.prototype.updateData=function(e,t){e=this.find(e);return e.forEach(function(e){return e.setData(t(e))}),e},E.prototype.getNodeById=function(t){var n=null;return d(this.model,function(e){if(""+e.id===t)return n=e,!1}),n},E.prototype.getNode=function(e){return this.isNode(e)?e:null},E.prototype.objectToNode=function(e){return x(this,e)};var A=37,M=38,j=39,I=40,B=32,F=46,z=13,U=27,Y=[37,38,39,40,32];function X(s){s.vm.$el.addEventListener("keydown",function(e){var t,n,i,r=e.keyCode,o=s.activeElement;if(s.isNode(o))if(o.isEditing){if(r===U)return o.stopEditing(!1)}else switch(Y.includes(r)&&(e.preventDefault(),e.stopPropagation()),r){case A:return void((i=o).expanded()?i.collapse():(i=i.parent)&&i.focus());case j:return void((i=o).collapsed()?i.expand():(i=i.first())&&i.focus());case M:return function e(t,n){n=t.prevVisibleNode(n);if(n)return n.disabled()?e(t,n):void n.focus()}(s,o);case I:return function e(t,n){n=t.nextVisibleNode(n);if(n)return n.disabled()?e(t,n):void n.focus()}(s,o);case B:case z:return n=o,void(s.options.checkbox&&(n.checked()?n.uncheck():n.check()));case F:return n=o,void((t=(t=s).options.deletion)&&("function"==typeof t?!0===t(n)&&n.remove():!0===t&&n.remove()))}},!0)}var T={ABOVE:"drag-above",BELOW:"drag-below",ON:"drag-on"};function J(e){if(e.path)return e.path;if(e.composedPath)return e.composedPath();for(var t=e.target,n=[];t;){if(n.push(t),"HTML"===t.tagName)return n.push(document),n.push(window),n;t=t.parentElement}return n}function V(e){e=function(e){for(var t,n=0,i=J(e);n<i.length;n++)if(t=i[n].className||"",/tree-node/.test(t))return i[n];return null}(e);return e||null}function L(e,t){if(e){var n=e.className;if(t)new RegExp(t).test(n)||(n+=" "+t);else{for(var i in T)n=n.replace(T[i],"");n.replace("dragging","")}e.className=n.replace(/\s+/g," ")}}function P(e,t,n){if(t&&t[n]&&"function"==typeof t[n])return!1!==t[n].apply(t,e)}var q={direction:"ltr",multiple:!0,checkbox:!(E.prototype.parse=function(e,t){t=t||this.options.propertyNames;try{return N(e,this,t)}catch(e){return[]}}),checkOnSelect:!1,autoCheckChildren:!0,autoDisableChildren:!0,checkDisabledChildren:!0,parentSelect:!1,keyboardNavigation:!0,nodeIndent:24,minFetchDelay:0,fetchData:null,propertyNames:null,deletion:!1,dnd:!1,editing:!1,onFetchError:function(e){throw e}},H={emptyText:"Nothing found!",matcher:function(e,t){var n=new RegExp(e,"i").test(t.text);return!(n&&t.parent&&new RegExp(e,"i").test(t.parent.text))&&n},plainList:!1,showChildren:!0},b={name:"Tree",components:{TreeNode:i,DraggableNode:e},mixins:[{methods:{connectStore:function(e){var n=this,t=e.store,i=e.mutations,r=e.getter,o=e.dispatcher;O("function"==typeof r,"`getter` must be a function"),O("function"==typeof o,"`dispatcher` must be a function"),void 0!==i&&O(Array.isArray(i),"`mutations` must be an array"),t.subscribe(function(e,t){(!i||i.includes(e.type))&&n.tree.setModel(r())}),this.tree.setModel(r()),this.$on("LIQUOR_NOISE",function(){n.$nextTick(function(e){o(n.toJSON())})})},recurseDown:function(e){this.tree.recurseDown(e)},selected:function(){return this.tree.selected()},checked:function(){return this.tree.checked()},append:function(e,t){return t?this.tree.append(e,t):this.tree.addToModel(e,this.tree.model.length)},prepend:function(e,t){return t?this.tree.prepend(e,t):this.tree.addToModel(e,0)},addChild:function(e,t){return this.append(e,t)},remove:function(e,t){return this.tree.remove(e,t)},before:function(e,t){return t?this.tree.before(e,t):this.prepend(e)},after:function(e,t){return t?this.tree.after(e,t):this.append(e)},find:function(e,t){return this.tree.find(e,t)},findAll:function(e){return this.tree.find(e,!0)},expandAll:function(){return this.tree.expandAll()},updateData:function(e,t){return this.tree.updateData(e,t)},collapseAll:function(){return this.tree.collapseAll()},sortTree:function(e,t){return this.tree.sortTree(e,t)},sort:function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];return(e=this.tree).sort.apply(e,t)},setModel:function(e){return this.tree.setModel(e)},getRootNode:function(){return 1===this.tree.model.length?this.tree.model[0]:this.tree.model},toJSON:function(){return JSON.parse(JSON.stringify(this.model))}}},{methods:{onDragStart:function(e){e.preventDefault()},startDragging:function(e,t){e.isDraggable()&&!1!==P([e],this.tree.options.dnd,"onDragStart")&&(this.$$startDragPosition=[t.clientX,t.clientY],this.$$possibleDragNode=e,this.initDragListeners())},initDragListeners:function(){var h,l=this,p=function(){window.removeEventListener("mouseup",e,!0),window.removeEventListener("mousemove",t,!0)},e=function(e){l.$$startDragPosition||e.stopPropagation(),l.draggableNode&&l.draggableNode.node.state("dragging",!1),l.$$dropDestination&&l.tree.isNode(l.$$dropDestination)&&l.$$dropDestination.vm&&(L(l.$$dropDestination.vm.$el,null),!1!==P([l.draggableNode.node,l.$$dropDestination,h],l.tree.options.dnd,"onDragFinish")&&(l.$$dropDestination.isDropable()||h!==T.ON)&&h&&(l.draggableNode.node.finishDragging(l.$$dropDestination,h),l.draggableNode.node.parent=l.$$dropDestination),l.$$dropDestination=null),l.$$possibleDragNode=null,l.$set(l,"draggableNode",null),p()},t=function(e){if(!l.$$startDragPosition||(i=e,a=l.$$startDragPosition,5<Math.abs(i.clientX-a[0])||5<Math.abs(i.clientY-a[1]))){if(l.$$startDragPosition=null,l.$$possibleDragNode){if(!1===l.$$possibleDragNode.startDragging())return p(),void(l.$$possibleDragNode=null);l.$set(l,"draggableNode",{node:l.$$possibleDragNode,left:0,top:0}),l.$$possibleDragNode=null}l.draggableNode.left=e.clientX,l.draggableNode.top=e.clientY;var t,n,i=V(e),r=l.$el;for(n in T)for(var o=r.querySelectorAll("."+T[n]),s=0;s<o.length;s++)L(o[s]);if(i){var a=i.getAttribute("data-id");if(l.draggableNode.node.id!==a){if(l.$$dropDestination&&l.$$dropDestination.id===a||(l.$$dropDestination=l.tree.getNodeById(a)),l.$$dropDestination&&l.draggableNode.node)if(l.$$dropDestination.getPath().includes(l.draggableNode.node))return void(l.$$dropDestination=null);e=e,c=(d=(d=i).getBoundingClientRect()).height/3,t=T.ON,d.top+c>=e.clientY?t=T.ABOVE:d.top+2*c<=e.clientY&&(t=T.BELOW),h=t;var d=P([l.draggableNode.node,l.$$dropDestination,h],l.tree.options.dnd,"onDragOn"),c=l.$$dropDestination.isDropable()&&!1!==d;L(i,h=c||h!==T.ON?h:null)}}}};window.addEventListener("mouseup",e,!0),window.addEventListener("mousemove",t,!0)}}}],props:{data:{},options:{type:Object,default:function(e){return{}}},filter:String,tag:{type:String,default:"div"}},provide:function(){var e=this;return{tree:t.computed(function(){return e.tree})}},mounted:function(){var e,t=this,n=new E(this);this.tree=n,!this.data&&this.opts.fetchData?e=n.fetchInitData():this.data&&this.data.then?(e=this.data,this.loading=!0):e=Promise.resolve(this.data),e.then(function(e){e=e||[],t.opts.store?t.connectStore(t.opts.store):t.tree.setModel(e),t.loading&&(t.loading=!1),t.$emit("tree:mounted",t),S(t)}),!1!==this.opts.keyboardNavigation&&X(n)},data:function(){var e=Object.assign({},q,this.options);return e.filter=Object.assign({},H,e.filter),{model:[],tree:null,loading:!1,opts:e,matches:[],draggableNode:null}},computed:{visibleModel:function(){return this.model.filter(function(e){return e&&e.visible()})},visibleMatches:function(){return this.matches.filter(function(e){return e&&e.visible()})}},watch:{filter:function(e){this.tree.filter(e)}}},R=n({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.tag,{tag:"component",class:{tree:!0,"tree-loading":this.loading,"tree--draggable":!!this.draggableNode},attrs:{role:"tree"}},[t.filter&&0==t.matches.length?[n("div",{staticClass:"tree-filter-empty",domProps:{innerHTML:t._s(t.opts.filter.emptyText)}})]:[n("ul",{staticClass:"tree-root",on:{dragstart:t.onDragStart}},[t.opts.filter.plainList&&0<t.matches.length?t._l(t.visibleMatches,function(e){return n("TreeNode",{key:e.id,attrs:{node:e,options:t.opts,tree:t.tree}})}):t._l(t.visibleModel,function(e){return n("TreeNode",{key:e.id,attrs:{node:e,options:t.opts}})})],2)],t._v(" "),t.draggableNode?n("DraggableNode",{attrs:{target:t.draggableNode}}):t._e()],2)},staticRenderFns:[]},function(e){e&&e("data-v-2b64309e_0",{source:".tree{overflow:auto}.tree-children,.tree-root{list-style:none;padding:0}.tree>.tree-filter-empty,.tree>.tree-root{padding:3px;box-sizing:border-box}.tree.tree--draggable .tree-node:not(.selected)>.tree-content:hover{background:0 0}.drag-above,.drag-below,.drag-on{position:relative;z-index:1}.drag-on>.tree-content{background:#fafcff;outline:1px solid #7baff2}.drag-above>.tree-content::before,.drag-below>.tree-content::after{display:block;content:'';position:absolute;height:8px;left:0;right:0;z-index:2;box-sizing:border-box;background-color:#3367d6;border:3px solid #3367d6;background-clip:padding-box;border-bottom-color:transparent;border-top-color:transparent;border-radius:0}.drag-above>.tree-content::before{top:0;transform:translateY(-50%)}.drag-below>.tree-content::after{bottom:0;transform:translateY(50%)}",map:void 0,media:void 0})},b,void 0,!(b.__file="TreeRoot.vue"),void 0,o,void 0);return R.install=function(e){e.component(R.name,R)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(R),R});
//# sourceMappingURL=liquor-tree.umd.js.map
